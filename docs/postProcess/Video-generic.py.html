<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <!-- 
    IMPORTANT: DO NOT place empty anchor tags <a></a> in this template!
    They cause JavaScript syntax errors when they appear inside script blocks.
  -->
  <!-- Eliminate FOUC (Flash of Unstyled Content) and FOUT (Flash of Incorrect Theme) -->
  <script>
    (function() {
  try {
    // Apply the theme as quickly as possible to avoid flash
    let saved;
    try {
      saved = localStorage.getItem('theme');
    } catch (storageError) {
      // Handle localStorage access errors (private browsing, cookies disabled)
      console.warn('Unable to access localStorage:', storageError);
    }

    let prefersDark = false;
    try {
      prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    } catch (mediaError) {
      // Handle matchMedia access errors (unsupported browsers)
      console.warn('Unable to check media query:', mediaError);
    }

    const theme = saved ? saved : (prefersDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
    // Add theme class for CSS targeting
    document.documentElement.classList.add(theme + '-theme');
    // Mark when theme is set for CSS transitions
    document.documentElement.classList.add('theme-set');
  } catch (error) {
    // Fallback for any other unexpected errors
    console.warn('Theme initialization failed:', error);
    // Apply default theme as fallback
    try {
      document.documentElement.setAttribute('data-theme', 'light');
      document.documentElement.classList.add('light-theme');
      document.documentElement.classList.add('theme-set');
    } catch (fallbackError) {
      // Silent catch for extreme cases
      console.error('Critical theme fallback failed:', fallbackError);
    }
  }
})();
  </script>


  <!-- No-JS fallback for theme and critical theming styles -->
  <style>
    /* Default light theme variables */
    :root {
      /* Base colors */
      --color-background: #fff;
      --color-text: #333;
      --color-primary: #0066cc;
      --color-secondary: #036;
      --color-accent: #0099ff;
      
      /* UI elements */
      --color-header-bg: #f5f5f5;
      --color-footer-bg: #2d2e33;
      --color-border: #e0e0e0;
      --color-input-bg: #f9f9f9;
      
      /* Component colors */
      --color-preloader-bg: #ffffff;
      --color-loader: #0066cc;
      --color-card-bg: #ffffff;
      --color-code-bg: #f5f5f5;
    }
    
    /* Dark theme variables applied via media query when JS is disabled */
    @media (prefers-color-scheme: dark) {
      :root:not(.theme-set) {
        /* Base colors - dark mode */
        --color-background: #1a1a1a;
        --color-text: #f5f5f5;
        --color-primary: #4d9fff;
        --color-secondary: #88ccff;
        --color-accent: #00bfff;
        
        /* UI elements - dark mode */
        --color-header-bg: #121212;
        --color-footer-bg: #121212;
        --color-border: #333;
        --color-input-bg: #2d2d2d;
        
        /* Component colors - dark mode */
        --color-preloader-bg: #1a1a1a;
        --color-loader: #4d9fff;
        --color-card-bg: #222;
        --color-code-bg: #2d2d2d;
      }
    }
    
    /* When JS sets the theme explicitly via data attribute */
    [data-theme="dark"] {
      /* Base colors - dark mode */
      --color-background: #1a1a1a;
      --color-text: #f5f5f5;
      --color-primary: #4d9fff;
      --color-secondary: #88ccff;
      --color-accent: #00bfff;
      
      /* UI elements - dark mode */
      --color-header-bg: #121212;
      --color-footer-bg: #121212;
      --color-border: #333;
      --color-input-bg: #2d2d2d;
      
      /* Component colors - dark mode */
      --color-preloader-bg: #1a1a1a;
      --color-loader: #4d9fff;
      --color-card-bg: #222;
      --color-code-bg: #2d2d2d;
    }
    
    /* Prevent transition flashes during initial load */
    html:not(.transitions-enabled) * {
      transition: none !important;
    }
    
    /* Apply theme to preloader and early elements */
    #preloader {
      background-color: var(--color-preloader-bg);
      color: var(--color-text);
    }
    
    #loader {
      border-color: var(--color-loader);
      border-top-color: transparent;
    }
    
    /* Noscript warning */
    .noscript-warning {
      background-color: var(--color-primary);
      color: white;
      text-align: center;
      padding: 10px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
    
    /* Theme indicator for no-JS */
    .theme-indicator {
      padding: 5px 10px;
      border-radius: 4px;
      background-color: var(--color-input-bg);
      color: var(--color-text);
      text-align: center;
    }
    
    /* Hide JS-only elements when no JS */
    .no-js .js-only {
      display: none !important;
    }
    
    /* Show no-JS alternatives */
    .js .no-js-only {
      display: none !important;
    }
  </style>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="base-url" content="..">
  <title>postProcess/Video-generic.py | Drop Impact Simulations</title>
  
  <!-- Critical CSS for fastest paint -->
  <style>
      .s-intro__title {
          visibility: visible;
          font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      .s-header {
          visibility: visible;
      }
      
      /* Ensure theme toggle properly styled immediately */
      .theme-toggle {
          background-color: var(--color-background);
          color: var(--color-text);
      }
      
      /* Control SVG visibility based on theme */
      [data-theme="dark"] .theme-toggle-icon.sun,
      :root:not([data-theme="dark"]) .theme-toggle-icon.moon {
          display: block;
      }
      
      [data-theme="dark"] .theme-toggle-icon.moon,
      :root:not([data-theme="dark"]) .theme-toggle-icon.sun {
          display: none;
      }
  </style>

  <!-- Critical Meta Tags -->
  <meta name="description" content="Generic video post-processing pipeline for Basilisk drop-impact runs. Overview -------- The helper executables postProcess/getFacet and postProcess/getData-g...">
  <meta name="author" content="CoMPhy Lab">
  <meta name="robots" content="index, follow">
  <meta name="keywords" content="add_colorbar, class, domainbounds, main, mirrors, parse_arguments, process_timestep, rmin, swaps, video">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-title" content="CoMPhy Lab">

  <!-- Preload critical resources -->
  <link rel="preload" href="../assets/js/main.js" as="script">
  <link rel="preload" href="../assets/css/fontello/css/fontello.css" as="style">
  <link rel="preload" href="../assets/css/academicons-1.7.0/css/academicons.min.css" as="style">

  <!-- Base stylesheets -->
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="stylesheet" href="../assets/css/custom_styles.css">
  <link rel="stylesheet" href="../assets/css/command-palette.css">
  <link rel="stylesheet" href="../assets/css/fontello/css/fontello.css">
  <link rel="stylesheet" href="../assets/css/academicons-1.7.0/css/academicons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">

  <!-- Font optimization -->
  <style>
      @font-face {
          font-display: swap;
          font-family: 'System Font';
          src: local('system-ui');
      }
  </style>

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="96x96" href="../assets/favicon/favicon-96x96.png">
  <link rel="icon" type="image/svg+xml" href="../assets/favicon/favicon.svg">
  <link rel="shortcut icon" href="../assets/favicon/favicon.ico">
  <link rel="manifest" href="../assets/favicon/site.webmanifest">

  <!-- Scripts with proper loading attributes -->
  <script src="../assets/js/jquery.min.js"></script>
  <script src="../assets/js/jquery-ui.packed.js"></script>
  <script src="../assets/js/plots.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
  <!-- Config script must load before other scripts -->
  <script src="../assets/js/config.js"></script>
  <script defer src="../assets/js/html-sanitizer.js"></script>
  <script defer src="../assets/js/search-helper.js"></script>
  <script defer src="../assets/js/command-palette.js"></script>
  <script defer src="../assets/js/command-data.js"></script>
  <script defer src="../assets/js/main.js"></script>
  <script defer src="../assets/js/theme-toggle.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
  
  <!-- Optimize page load performance -->
  <script>
    // Preconnect to critical domains
    const preconnectDomains = [
      'https://cdnjs.cloudflare.com',
      'https://cdn.jsdelivr.net'
    ];
    
    preconnectDomains.forEach(domain => {
      const link = document.createElement('link');
      link.rel = 'preconnect';
      link.href = domain;
      link.crossOrigin = 'anonymous';
      document.head.appendChild(link);
      
      // Also add DNS prefetch as fallback
      const dnsLink = document.createElement('link');
      dnsLink.rel = 'dns-prefetch';
      dnsLink.href = domain;
      document.head.appendChild(dnsLink);
    });
    
    // Detect when document is fully loaded to remove preloader
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      if (preloader) {
        preloader.style.opacity = '0';
        setTimeout(() => {
          preloader.style.display = 'none';
        }, 300); // Match transition duration
      }
    });
  </script>

  <script>
      // Load Font Awesome with proper environment detection and fallbacks
      function loadStylesheet(href) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = href;
        link.crossOrigin = 'anonymous';
        link.onerror = (e) => {
          console.error(`Failed to load stylesheet: `, e);
          console.log('Trying alternative Font Awesome source...');
        };
        document.head.appendChild(link);
        return link;
      }
      
      // Check if we're on localhost
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        // Use hardcoded version numbers for reliable loading
        
        // Load Font Awesome using multiple CDNs to maximize reliability for local development
        loadStylesheet('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css');
        // Backup CDN if the first one fails
        loadStylesheet('https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css');
        // Final local fallback - ensures it will work on any localhost environment
        loadStylesheet('https://use.fontawesome.com/releases/v6.7.2/css/all.css');
      } else {
        // Use Kit for production with defer
        var script = document.createElement('script');
        script.src = 'https://kit.fontawesome.com/b1cfd9ca75.js';
        script.crossOrigin = 'anonymous';
        script.defer = true;
        document.head.appendChild(script);
      }
    </script>

  <script>
      // Mark page as JS-enabled and manage transitions
      document.documentElement.classList.remove('no-js');
      document.documentElement.classList.add('js');
      
      // Allow CSS transitions after initial load to prevent transition flashes
      window.addEventListener('DOMContentLoaded', () => {
          setTimeout(() => {
              document.documentElement.classList.add('transitions-enabled');
          }, 100); // Short delay to ensure DOM is ready
      });
  </script>
</head>
<body id="top">
<script>window.repoName = "Drop-Impact";</script>


    <!-- Preloader with theme variables applied -->
    <div id="preloader">
        <div id="loader"></div>
    </div>

    <noscript>
        <div class="noscript-warning">
            <p>This site works best with JavaScript enabled. Some features may be limited.</p>
        </div>
    </noscript>

    <div id="page" class="s-pagewrap">
        <header class="s-header">
            <div class="s-header__logo">
                <a class="logo" href="/">
                    <img src="../assets/logos/CoMPhy-Lab-no-name.png" alt="CoMPhy Lab">
                </a>
                <a class="documentation-button" href="/Drop-Impact">
                    <i class="fa-solid fa-book-open"></i>
                    <span>Drop-Impact</span>
                </a>
            </div>
            <a class="s-header__menu-toggle" href="#0">
                <span class="s-header__menu-text">Menu</span>
                <span class="s-header__menu-icon"></span>
            </a>
            <nav class="s-header__nav">
                <a href="#0" class="s-header__nav-close-btn"><span>Close</span></a>
                <ul class="s-header__nav-list">
                    <li style="background: none;">
                        <!-- JS theme toggle -->
                        <div class="theme-toggle js-only" id="theme-toggle" aria-label="Toggle dark/light theme">
                            <svg class="theme-toggle-icon moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <svg class="theme-toggle-icon sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                        </div>
                    </li>
                    <li style="background: none;"><a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" style="background: none; padding: 0;" aria-label="Google Scholar Profile"><i class="ai ai-google-scholar" style="font-size: 1.75em;"></i></a></li>
                    <li style="background: none;"><a href="https://github.com/comphy-lab" style="background: none; padding: 0;" aria-label="GitHub Organization"><i class="fa-brands fa-github" style="font-size: 1.75em"></i></a></li>
                    <li><a href="https://comphy-lab.org/#about" class="smoothscroll">About</a></li>
                    <li><a href="https://comphy-lab.org/team/">Team</a></li>
                    <li><a href="https://comphy-lab.org/research">Research</a></li>
                    <li><a href="https://comphy-lab.org/teaching">Teaching</a></li>
                    <li><a href="https://comphy-lab.org/join">Join Us</a></li>
                    <li><a href="https://blogs.comphy-lab.org/">Blog</a></li>
                    <li style="background: none;"><a href="https://bsky.app/profile/comphy-lab.org" style="background: none; padding: 0;" aria-label="Bluesky Profile"><i class="fa-brands fa-bluesky" style="font-size: 1.75em; color: #0085ff;"></i></a></li>
                    <!-- Command Palette Button (Styled like search) -->
                    <li class="command-palette-button">
                        <div class="command-wrapper">
                            <button class="command-k-style-btn" id="command-palette-btn" aria-label="Open command palette">
                                <span class="default-theme-text">ctrl K</span>
                                <span class="mac-theme-text">⌘ K</span>
                                <i class="fa-solid fa-magnifying-glass search-icon"></i>
                            </button>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- Main content -->
        <main class="content">
            
            <div class="page-content">
                
                                <h1 class="page-title">postProcess/Video-generic.py</h1>
                
                                <nav class="table-of-contents" id="TOC">
                    <ul>
                    <li><a href="#overview"
                    id="toc-overview">Overview</a></li>
                    <li><a href="#usage" id="toc-usage">Usage</a></li>
                    </ul>
                </nav>
                                
                                <div class="raw-file-button-container">
                    <a href="https://github.com/comphy-lab/Drop-Impact/raw/main/postProcess/Video-generic.py" class="raw-file-button" target="_blank" rel="noopener noreferrer">
                        <i class="fa-brands fa-github"></i> See raw file
                    </a>
                </div>
                
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Vatsal Sanjay</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vatsal.sanjay@comphy-lab.org</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CoMPhy Lab</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Durham University</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Last updated: Nov 17, 2025</span></span></code></pre></div></div>
                <p>Generic video post-processing pipeline for Basilisk
                drop-impact runs.</p>
                <h2 id="overview">Overview</h2>
                <p>The helper executables
                <code>postProcess/getFacet</code> and
                <code>postProcess/getData-generic</code> are compiled as
                part of the Basilisk workflow. This Python wrapper
                shells out to those binaries for every snapshot,
                reshapes the returned grids, and renders angularly
                mirrored visualisations. Keeping everything in a
                mono-file but with concrete building blocks mirrors the
                literate C/H style described in CLAUDE.md and keeps the
                documentation tooling
                (<code>.github/scripts/build.sh</code>) happy.</p>
                <h2 id="usage">Usage</h2>
                <p>Typical invocation from the repository root::</p>
                <p>python3 postProcess/Video-generic.py –caseToProcess
                simulationCases/1234/results</p>
                <p>Command-line switches expose all relevant knobs (grid
                density, domain limits, time stride, CPU count). The
                output directory is created on-demand and filled with
                zero-padded PNG files compatible with downstream
                stitching utilities.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing <span class="im">as</span> mp</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess <span class="im">as</span> sp</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Sequence, Tuple</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.collections <span class="im">import</span> LineCollection</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> StrMethodFormatter</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure matplotlib with LaTeX if available, fallback otherwise</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">&quot;font.family&quot;</span>] <span class="op">=</span> <span class="st">&quot;serif&quot;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> shutil.which(<span class="st">&quot;latex&quot;</span>):</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        matplotlib.rcParams[<span class="st">&quot;text.usetex&quot;</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        matplotlib.rcParams[<span class="st">&quot;text.latex.preamble&quot;</span>] <span class="op">=</span> <span class="vs">r&quot;\usepackage</span><span class="sc">{amsmath}</span><span class="vs">&quot;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        matplotlib.rcParams[<span class="st">&quot;text.usetex&quot;</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    matplotlib.rcParams[<span class="st">&quot;text.usetex&quot;</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span>(frozen<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DomainBounds:</span></code></pre></div></div>
                <p>Symmetry-aware domain description in cylindrical
                coordinates.</p>
                <p>The code expects r in [rmin, rmax] with rmin &lt;= 0
                to leverage the axis of symmetry; z spans freely between
                zmin and zmax. Packaging these values avoids argument
                soup when plotting or generating overlays.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    rmin: <span class="bu">float</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    rmax: <span class="bu">float</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    zmin: <span class="bu">float</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    zmax: <span class="bu">float</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span>(frozen<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RuntimeConfig:</span></code></pre></div></div>
                <p>Run-time knobs collected from CLI arguments.</p>
                <p>Multiprocessing workers only need a single instance
                of this struct, making later CLI additions painless. The
                accessors keep mirror operations (e.g., computing rmin)
                in one place.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    cpus: <span class="bu">int</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    n_snapshots: <span class="bu">int</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    grids_per_r: <span class="bu">int</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    tsnap: <span class="bu">float</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    zmin: <span class="bu">float</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    zmax: <span class="bu">float</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    rmax: <span class="bu">float</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    case_dir: <span class="bu">str</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    output_dir: <span class="bu">str</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rmin(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span><span class="va">self</span>.rmax</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bounds(<span class="va">self</span>) <span class="op">-&gt;</span> DomainBounds:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> DomainBounds(<span class="va">self</span>.rmin, <span class="va">self</span>.rmax, <span class="va">self</span>.zmin, <span class="va">self</span>.zmax)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span>(frozen<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PlotStyle:</span></code></pre></div></div>
                <p>Single source of truth for plot-level choices.</p>
                <p>Matplotlib tweaks become traceable: alter colours,
                fonts, or geometry here and every rendered frame will
                stay consistent without touching plotting logic.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    figure_size: Tuple[<span class="bu">float</span>, <span class="bu">float</span>] <span class="op">=</span> (<span class="fl">19.20</span>, <span class="fl">10.80</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    tick_label_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    zero_axis_color: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    axis_color: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    line_width: <span class="bu">float</span> <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    interface_color: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;#00B2FF&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    colorbar_width: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    left_colorbar_offset: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.04</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    right_colorbar_offset: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span>(frozen<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SnapshotInfo:</span></code></pre></div></div>
                <p>Metadata for an input snapshot and its output
                image.</p>
                <p>Storing paths and the physical time together
                simplifies filename logic and ensures logging statements
                stay informative.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    index: <span class="bu">int</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    time: <span class="bu">float</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    source: <span class="bu">str</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    target: <span class="bu">str</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FieldData:</span></code></pre></div></div>
                <p>Structured holder around the grids returned by
                getData-generic.</p>
                <p>Attributes provide convenient min/max queries so the
                plotting routine does not need to recalculate extents or
                worry about array shapes.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>    R: np.ndarray</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    Z: np.ndarray</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    strain_rate: np.ndarray</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    velocity: np.ndarray</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    nz: <span class="bu">int</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> radial_extent(<span class="va">self</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>]:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.R.<span class="bu">min</span>(), <span class="va">self</span>.R.<span class="bu">max</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> axial_extent(<span class="va">self</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>]:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.Z.<span class="bu">min</span>(), <span class="va">self</span>.Z.<span class="bu">max</span>()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>PLOT_STYLE <span class="op">=</span> PlotStyle()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_status(message: <span class="bu">str</span>, <span class="op">*</span>, level: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;INFO&quot;</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span></code></pre></div></div>
                <p>timestamp = datetime.now().strftime(“%H:%M:%S”)
                print(f”[{timestamp}] [{level}] {message}“,
                flush=True)</p>
                <p>def parse_arguments() -&gt; RuntimeConfig:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>    The returned dataclass <span class="kw">is</span> immutable <span class="kw">and</span> can be safely shared across</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    multiprocessing workers without coordination overhead. This design</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    makes future CLI additions trivial.</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        RuntimeConfig: Configuration <span class="bu">object</span> containing:</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> cpus: Number of parallel workers (default: <span class="dv">4</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> n_snapshots: Total frames to process (default: <span class="dv">4000</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> grids_per_r: Radial mesh resolution (default: <span class="dv">64</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> tsnap: Time interval between snapshots (default: <span class="fl">0.01</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> Domain bounds (zmin, zmax, rmax)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> I<span class="op">/</span>O paths (case_dir, output_dir)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    Examples:</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;&gt;</span> config <span class="op">=</span> parse_arguments()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;&gt;</span> config.cpus</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;&gt;</span> config.bounds</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        DomainBounds(rmin<span class="op">=-</span><span class="fl">4.0</span>, rmax<span class="op">=</span><span class="fl">4.0</span>, zmin<span class="op">=</span><span class="fl">0.0</span>, zmax<span class="op">=</span><span class="fl">4.0</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    See Also:</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        RuntimeConfig: Full specification of configuration fields</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        DomainBounds: Domain geometry description</span></code></pre></div></div>
                <p>parser =
                argparse.ArgumentParser(description=“Generate snapshot
                videos.”) parser.add_argument(“–CPUs”, type=int,
                default=4, help=“Number of CPUs to use”)
                parser.add_argument( “–nGFS”, type=int, default=4000,
                help=“Number of restart files to process” )
                parser.add_argument( “–GridsPerR”, type=int,
                default=256, help=“Number of grids per R” )
                parser.add_argument(“–ZMAX”, type=float, default=4.0,
                help=“Maximum Z value”) parser.add_argument(“–RMAX”,
                type=float, default=4.0, help=“Maximum R value”)
                parser.add_argument(“–ZMIN”, type=float, default=0.0,
                help=“Minimum Z value”) parser.add_argument(“–tsnap”,
                type=float, default=0.01, help=“Time snap”)
                parser.add_argument( “–caseToProcess”, type=str,
                default=“simulationCases/1000/results”, help=“Case to
                process”, ) parser.add_argument( “–folderToSave”,
                type=str, default=“simulationCases/1000/results/Video”,
                help=“Folder to save” ) args = parser.parse_args()</p>
                <p>return RuntimeConfig( cpus=args.CPUs,
                n_snapshots=args.nGFS, grids_per_r=args.GridsPerR,
                tsnap=args.tsnap, zmin=args.ZMIN, zmax=args.ZMAX,
                rmax=args.RMAX, case_dir=args.caseToProcess,
                output_dir=args.folderToSave, )</p>
                <p>def ensure_directory(path: str) -&gt; None:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>    Create an output directory <span class="cf">if</span> it does <span class="kw">not</span> exist.</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        path: Directory to create (including parents).</span></code></pre></div></div>
                <p>if not os.path.isdir(path): os.makedirs(path,
                exist_ok=True)</p>
                <p>def run_helper(command: Sequence[str]) -&gt;
                Sequence[str]:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>    Run a helper executable <span class="kw">and</span> <span class="cf">return</span> its stderr <span class="im">as</span> decoded lines.</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    The compiled helpers deliberately emit their payload to stderr, so stdout <span class="kw">is</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    ignored (it <span class="kw">is</span> typically empty) <span class="kw">and</span> we bubble up informative stderr content.</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        command: Command <span class="bu">list</span> passed to subprocess.</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>[<span class="bu">str</span>]: Decoded stderr lines produced by the helper.</span></code></pre></div></div>
                <p>process = sp.Popen(command, stdout=sp.PIPE,
                stderr=sp.PIPE) _, stderr = process.communicate() if
                process.returncode != 0: raise RuntimeError( f”Command
                {’ ‘.join(command)} failed with code
                {process.returncode}:” f”{stderr.decode(’utf-8’)}” )
                return stderr.decode(“utf-8”).split(“”)</p>
                <p>def get_facets(filename: str):</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    Shells out to the compiled ``getFacet`` executable, which extracts the</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    volume<span class="op">-</span>of<span class="op">-</span>fluid (VOF) interface <span class="im">as</span> a sequence of line segments. Since</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    the Basilisk simulation uses axisymmetric coordinates, only the r ≥ <span class="dv">0</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    half <span class="kw">is</span> computed. This function mirrors each segment about r<span class="op">=</span><span class="dv">0</span> to create</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    the full visualization.</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    Args:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        filename: Path to Basilisk snapshot <span class="bu">file</span> (e.g., <span class="st">&#39;snapshot-0.0100&#39;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>[<span class="bu">tuple</span>]: Sequence of line segments, each <span class="im">as</span> ((r1, z1), (r2, z2)).</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            Each physical segment appears twice: once at <span class="op">+</span>r <span class="kw">and</span> once at <span class="op">-</span>r</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> the mirrored visualization. Empty <span class="bu">list</span> <span class="cf">if</span> fewer than <span class="dv">100</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            output lines (likely indicates no interface present).</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    Note:</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        The getFacet helper outputs space<span class="op">-</span>separated (z, r) pairs. This</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        function swaps to (r, z) convention <span class="cf">for</span> matplotlib plotting.</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    See Also:</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        plot_snapshot: Uses returned segments <span class="cf">for</span> LineCollection rendering</span></code></pre></div></div>
                <p>temp2 = run_helper([“postProcess/getFacet”,
                filename]) segs = [] skip = False if len(temp2) &gt;
                1e2: for n1 in range(len(temp2)): temp3 =
                temp2[n1].split(” “) if temp3 == [””]: skip = False
                continue if not skip and n1 + 1 &lt; len(temp2): temp4 =
                temp2[n1 + 1].split(” “) r1, z1 =
                np.array([float(temp3[1]), float(temp3[0])]) r2, z2 =
                np.array([float(temp4[1]), float(temp4[0])])
                segs.append(((r1, z1), (r2, z2))) segs.append(((-r1,
                z1), (-r2, z2))) skip = True return segs</p>
                <p>def get_field(filename: str, zmin: float, zmax:
                float, rmax: float, nr: int) -&gt; FieldData:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>    Shells out to the compiled ``getData<span class="op">-</span>generic`` executable, which samples</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    the velocity <span class="kw">and</span> strain<span class="op">-</span>rate fields on a structured grid. Returns a</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    FieldData struct <span class="cf">with</span> reshaped <span class="dv">2</span><span class="er">D</span> arrays, abstracting away the flattening</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    scheme used by the helper.</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    Args:</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        filename: Path to Basilisk snapshot <span class="bu">file</span> (e.g., <span class="st">&#39;snapshot-0.0100&#39;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        zmin: Minimum axial coordinate <span class="cf">for</span> sampling domain</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        zmax: Maximum axial coordinate <span class="cf">for</span> sampling domain</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        rmax: Maximum radial coordinate (positive branch only)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        nr: Number of grid points <span class="kw">in</span> radial direction</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        FieldData: Structured container <span class="cf">with</span> reshaped <span class="dv">2</span><span class="er">D</span> arrays:</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> R, Z: Meshgrid coordinates (nz × nr)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> strain_rate: Second invariant of rate<span class="op">-</span>of<span class="op">-</span>strain tensor</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> velocity: Velocity magnitude field</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> nz: Number of grid points <span class="kw">in</span> axial direction (computed)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    Note:</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        The helper samples r ∈ [<span class="dv">0</span>, rmax], but plotting mirrors about r<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        to create the full axisymmetric visualization.</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    See Also:</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        FieldData: Structure definition <span class="cf">with</span> extent properties</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        plot_snapshot: Uses the returned FieldData <span class="cf">for</span> visualization</span></code></pre></div></div>
                <p>temp2 = run_helper( [ “postProcess/getData-generic”,
                filename, str(zmin), str(0), str(zmax), str(rmax),
                str(nr),] ) Rtemp, Ztemp, D2temp, veltemp = [], [], [],
                []</p>
                <p>for n1 in range(len(temp2)): temp3 =
                temp2[n1].split(” “) if temp3 == [“”]: continue
                Ztemp.append(float(temp3[0]))
                Rtemp.append(float(temp3[1]))
                D2temp.append(float(temp3[2]))
                veltemp.append(float(temp3[3]))</p>
                <p>R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 =
                np.asarray(D2temp) vel = np.asarray(veltemp) nz =
                int(len(Z) / nr)</p>
                <p>log_status(f”{filename}: nz = {nz}“)</p>
                <p>R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz,
                nr)) vel.resize((nz, nr))</p>
                <p>return FieldData(R=R, Z=Z, strain_rate=D2,
                velocity=vel, nz=nz)</p>
                <p>def build_snapshot_info(index: int, config:
                RuntimeConfig) -&gt; SnapshotInfo:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>    Construct <span class="bu">file</span> paths <span class="cf">for</span> a given timestep index.</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        index: Integer index used <span class="cf">with</span> ``tsnap`` to recover time.</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        config: RuntimeConfig providing directories <span class="kw">and</span> stride.</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        SnapshotInfo: Pre<span class="op">-</span>computed metadata <span class="cf">for</span> the worker.</span></code></pre></div></div>
                <p>time = config.tsnap * index source =
                os.path.join(config.case_dir, “intermediate”,
                f”snapshot-{time:.4f}“) target =
                os.path.join(config.output_dir, f”{int(time *
                1000):08d}.png”) return SnapshotInfo(index=index,
                time=time, source=source, target=target)</p>
                <p>def draw_domain_outline(ax, bounds: DomainBounds,
                style: PlotStyle) -&gt; None:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>    Outline computational domain <span class="kw">and</span> symmetry line.</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        ax: Matplotlib axis used <span class="cf">for</span> plotting.</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        bounds: Domain extents <span class="kw">in</span> both directions.</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        style: Colour<span class="op">/</span>width styling information.</span></code></pre></div></div>
                <p>ax.plot( [0, 0], [bounds.zmin, bounds.zmax], “-.”,
                color=style.zero_axis_color, linewidth=style.line_width,
                ) ax.plot( [bounds.rmin, bounds.rmin], [bounds.zmin,
                bounds.zmax], “-”, color=style.axis_color,
                linewidth=style.line_width, ) ax.plot( [bounds.rmin,
                bounds.rmax], [bounds.zmin, bounds.zmin], “-”,
                color=style.axis_color, linewidth=style.line_width, )
                ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmax,
                bounds.zmax], “-”, color=style.axis_color,
                linewidth=style.line_width, ) ax.plot( [bounds.rmax,
                bounds.rmax], [bounds.zmin, bounds.zmax], “-”,
                color=style.axis_color, linewidth=style.line_width,
                )</p>
                <p>def add_colorbar(fig, ax, mappable, *, align: str,
                label: str, style: PlotStyle):</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    Attach a vertical colorbar on the requested side of the axis.</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    Using manual axes lets us keep the main axis square <span class="cf">while</span> still showing two</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    distinct colour scales.</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        fig: Figure hosting the axes.</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        ax: Primary axes sharing its bounding box.</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        mappable: The image<span class="op">/</span>artist the colorbar describes.</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        align: <span class="st">&#39;left&#39;</span> <span class="kw">or</span> <span class="st">&#39;right&#39;</span> relative to the plotting axis.</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        label: Axis label to display.</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        style: PlotStyle values <span class="cf">for</span> spacing <span class="kw">and</span> typography.</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    Returns:</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        matplotlib.colorbar.Colorbar: The constructed colorbar.</span></code></pre></div></div>
                <p>l, b, w, h = ax.get_position().bounds if align ==
                “left”: position = [l - style.left_colorbar_offset, b,
                style.colorbar_width, h] else: position = [l + w +
                style.right_colorbar_offset, b, style.colorbar_width, h]
                cb_ax = fig.add_axes(position) colorbar =
                plt.colorbar(mappable, cax=cb_ax,
                orientation=“vertical”) colorbar.set_label(label,
                fontsize=style.tick_label_size, labelpad=5)
                colorbar.ax.tick_params(labelsize=style.tick_label_size)
                colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter(“{x:,.2f}”))
                if align == “left”:
                colorbar.ax.yaxis.set_ticks_position(“left”)
                colorbar.ax.yaxis.set_label_position(“left”) return
                colorbar</p>
                <p>def plot_snapshot( field_data: FieldData, facets,
                bounds: DomainBounds, snapshot: SnapshotInfo, style:
                PlotStyle, ) -&gt; None:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    Render <span class="kw">and</span> persist a single snapshot figure.</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    All artist construction lives here so multiprocessing workers only need to</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    fetch data <span class="kw">and</span> call this function.</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        field_data: Structured arrays <span class="cf">for</span> strain<span class="op">-</span>rate <span class="kw">and</span> velocity.</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        facets: Line segments representing the interface.</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        bounds: Domain extents that keep axes square.</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        snapshot: Metadata describing time <span class="kw">and</span> output <span class="bu">file</span>.</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        style: Plotting choices centralised <span class="kw">in</span> PlotStyle.</span></code></pre></div></div>
                <p>fig, ax = plt.subplots()
                fig.set_size_inches(*style.figure_size)</p>
                <p>draw_domain_outline(ax, bounds, style) line_segments
                = LineCollection( facets, linewidths=4,
                colors=style.interface_color, linestyle=“solid” )
                ax.add_collection(line_segments)</p>
                <p>rminp, rmaxp = field_data.radial_extent zminp, zmaxp
                = field_data.axial_extent</p>
                <p>cntrl1 = ax.imshow( field_data.strain_rate,
                cmap=“hot_r”, interpolation=“Bilinear”, origin=“lower”,
                extent=[-rminp, -rmaxp, zminp, zmaxp], vmax=0.0,
                vmin=-4.0, )</p>
                <p>cntrl2 = ax.imshow( field_data.velocity,
                interpolation=“Bilinear”, cmap=“Purples”,
                origin=“lower”, extent=[rminp, rmaxp, zminp, zmaxp],
                vmax=1.0, vmin=0.0, )</p>
                <p>ax.set_aspect(“equal”) ax.set_xlim(bounds.rmin,
                bounds.rmax) ax.set_ylim(bounds.zmin, bounds.zmax)
                ax.set_title(f”<span
                class="math inline">\(t/\\tau_0\)</span> =
                {snapshot.time:4.3f}“, fontsize=style.tick_label_size)
                ax.axis(”off”)</p>
                <p>add_colorbar( fig, ax, cntrl1, align=“left”,
                label=r”<span
                class="math inline">\(\left(\boldsymbol{\mathcal{D}:\mathcal{D}}\right)\)</span>“,
                style=style, ) add_colorbar( fig, ax, cntrl2,
                align=”right”, label=r”<span
                class="math inline">\(\|\boldsymbol{u}\|\)</span>“,
                style=style, )</p>
                <p>plt.savefig(snapshot.target, bbox_inches=“tight”)
                plt.close(fig)</p>
                <p>def process_timestep(index: int, config:
                RuntimeConfig, style: PlotStyle) -&gt; None:</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>    Worker executed <span class="cf">for</span> every timestep index.</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    Performs availability checks, loads helper outputs, <span class="kw">and</span> calls plot_snapshot.</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    Parameters:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        index: Integer timestep index relative to tsnap.</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        config: Runtime configuration shared across workers.</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        style: Plotting style shared by <span class="bu">all</span> frames.</span></code></pre></div></div>
                <p>snapshot = build_snapshot_info(index, config) if not
                os.path.exists(snapshot.source): log_status(f”Missing
                snapshot: {snapshot.source}“, level=”WARN”) return if
                os.path.exists(snapshot.target): log_status(f”Frame
                already exists, skipping: {snapshot.target}“) return</p>
                <p>log_status(f”Processing snapshot
                index={snapshot.index}, t={snapshot.time:.4f}“)</p>
                <p>try: facets = get_facets(snapshot.source) nr =
                int(config.grids_per_r * config.rmax) field_data =
                get_field( snapshot.source, config.zmin, config.zmax,
                config.rmax, nr ) plot_snapshot(field_data, facets,
                config.bounds, snapshot, style) except Exception as err:
                log_status( f”Error while processing {snapshot.source}:
                {err}“, level=”ERROR” ) raise</p>
                <p>log_status(f”Saved frame: {snapshot.target}“)</p>
                <p>def main():</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>    Entry point used by the documentation tooling <span class="kw">and</span> CLI.</span></code></pre></div></div>
                <div class="code-block-container"><pre><code>config = parse_arguments()
ensure_directory(config.output_dir)

with mp.Pool(processes=config.cpus) as pool:
    worker = partial(process_timestep, config=config, style=PLOT_STYLE)
    pool.map(worker, range(config.n_snapshots))</code></pre></div>
                <p>if <strong>name</strong> == “<strong>main</strong>”:
                main()</p>
            </div>
        </main>

        <footer class="site-footer">
            <div class="footer-left">
              <a href="https://basilisk.fr/sandbox/vatsal/" target="_blank" rel="noopener noreferrer">
                <img src="../assets/logos/logoBasilisk_TransparentBackground.png" alt="Basilisk C" class="footer-logo">
              </a>
              <a href="https://pof.tnw.utwente.nl/" target="_blank" rel="noopener noreferrer">
                <img src="../assets/logos/LogoPof_transparent_white.png" alt="Physics of Fluids" class="footer-logo pof-logo">
              </a>
              <a href="https://www.utwente.nl/" target="_blank" rel="noopener noreferrer">
                <img src="../assets/logos/UT_Logo_2400_Sta_White_EN.png" alt="University of Twente" class="footer-logo">
              </a>
              <a href="https://www.vatsalsanjay.com/" target="_blank" rel="noopener noreferrer">
                <img src="../assets/logos/Logo_Vatsal_v3_OutLine.png" alt="Vatsal Sanjay" class="footer-logo">
              </a>
            </div>
            <div class="footer-center">
              <p class="copyright-text">
                &copy; Copyright<br>
                CoMPhy Lab 2025
              </p>
            </div>
            <div class="footer-right">
              <a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" target="_blank" rel="noopener noreferrer" aria-label="Google Scholar Profile">
                <i class="ai ai-google-scholar" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab" target="_blank" rel="noopener noreferrer" aria-label="GitHub Organization">
                <i class="fa-brands fa-github" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://www.youtube.com/@CoMPhyLab" target="_blank" rel="noopener noreferrer" aria-label="YouTube Channel">
                <i class="fa-brands fa-youtube" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://x.com/VatsalSanjay" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter) Profile">
                <i class="fa-brands fa-x-twitter" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://bsky.app/profile/comphy-lab.org" target="_blank" rel="noopener noreferrer" aria-label="Bluesky Profile">
                <i class="fa-brands fa-bluesky" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab/Drop-Impact" class="edit-link" aria-label="Edit this page on GitHub">
                <i class="fa-brands fa-github"></i> Edit this page
              </a>
            </div>
          </footer>
    </div>  

    <!-- Command Palette -->
    <div id="simple-command-palette" class="simple-command-palette" style="display: none;">
        <div class="simple-command-palette-backdrop"></div>
        <div class="simple-command-palette-modal">
            <input type="text" id="command-palette-input" placeholder="Type a command..." autocomplete="off">
            <div id="command-palette-results" class="command-palette-results"></div>
            <div class="command-palette-footer">
                <span class="command-palette-footer-item"><kbd>↑</kbd> <kbd>↓</kbd> to navigate</span>
                <span class="command-palette-footer-item"><kbd>enter</kbd> to select</span>
                <span class="command-palette-footer-item"><kbd>esc</kbd> to close</span>
            </div>
        </div>
    </div>


<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    // Add copy button to each code block container
    const codeBlocks = document.querySelectorAll('.code-block-container pre');
    codeBlocks.forEach(function(codeBlock, index) {
        // Create button element
        const button = document.createElement('button');
        button.className = 'copy-button';
        button.textContent = 'Copy';
        button.setAttribute('aria-label', 'Copy code to clipboard');
        button.setAttribute('data-copy-state', 'copy');
        
        // Get the code block container (parent of the pre)
        const container = codeBlock.parentNode;
        
        // Add the button to the container
        container.appendChild(button);
        
        // Set up click event
        button.addEventListener('click', async function() {
            const codeText = codeBlock.textContent;
            
            try {
                // Try to use the modern clipboard API first
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(codeText);
                    updateButtonState(button, 'success');
                } else {
                    // Fall back to the deprecated execCommand method
                    const textarea = document.createElement('textarea');
                    textarea.value = codeText;
                    textarea.style.position = 'fixed';  // Prevent scrolling to the bottom
                    document.body.appendChild(textarea);
                    textarea.select();
                    
                    const successful = document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    if (successful) {
                        updateButtonState(button, 'success');
                    } else {
                        updateButtonState(button, 'error');
                    }
                }
            } catch (err) {
                console.error('Copy failed:', err);
                updateButtonState(button, 'error');
            }
        });
    });
    
    // Function to update button state
    function updateButtonState(button, state) {
        if (state === 'success') {
            button.textContent = 'Copied!';
            button.classList.add('copied');
        } else if (state === 'error') {
            button.textContent = 'Error!';
            button.classList.add('error');
        }
        
        // Reset button state after 2 seconds
        setTimeout(function() {
            button.textContent = 'Copy';
            button.classList.remove('copied', 'error');
        }, 2000);
    }
});
</script>
        </body>
</html>